app-id: io.github.simoninns.decode-orc
runtime: org.kde.Platform
runtime-version: '6.9'
sdk: org.kde.Sdk
command: orc-gui
finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --device=dri
  - --filesystem=host

modules:
  - name: nasm
    buildsystem: autotools
    sources:
      - type: archive
        url: https://www.nasm.us/pub/nasm/releasebuilds/2.16.01/nasm-2.16.01.tar.xz
        sha256: c77745f4802375efeee2ec5c0ad6b7f037ea9c87c92b149a9637ff099f162558

  - name: x264
    buildsystem: autotools
    config-opts:
      - --enable-shared
      - --enable-pic
      - --disable-cli
    sources:
      - type: git
        url: https://code.videolan.org/videolan/x264.git
        commit: 31e19f92f00c7003fa115047ce50978bc98c3a0d

  - name: x265
    buildsystem: cmake-ninja
    builddir: true
    subdir: source
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DENABLE_SHARED=ON
      - -DENABLE_CLI=OFF
    sources:
      - type: archive
        url: https://bitbucket.org/multicoreware/x265_git/downloads/x265_3.5.tar.gz
        sha256: e70a3335cacacbba0b3a20ec6fecd6783932288ebc8163ad74bcc9606477cae8

  - name: ffmpeg
    buildsystem: autotools
    config-opts:
      - --disable-shared
      - --enable-static
      - --enable-gpl
      - --enable-libx264
      - --enable-libx265
      - --disable-doc
      - --disable-programs
      - --enable-pic
      - --disable-vulkan
    sources:
      - type: archive
        url: https://ffmpeg.org/releases/ffmpeg-6.1.1.tar.xz
        sha256: 8684f4b00f94b85461884c3719382f1261f0d9eb3d59640a1f4ac0873616f968

  - name: libpng
    buildsystem: autotools
    config-opts:
      - --disable-shared
      - --enable-static
    sources:
      - type: archive
        url: https://downloads.sourceforge.net/libpng/libpng-1.6.40.tar.xz
        sha256: 535b479b2467ff231a3ec6d92a525906fb8ef27978be4f66dbe05d3f3a01b3a1

  - name: sqlite
    buildsystem: autotools
    config-opts:
      - --enable-threadsafe
      - --disable-shared
      - --enable-static
    sources:
      - type: archive
        url: https://www.sqlite.org/2024/sqlite-autoconf-3450100.tar.gz
        sha256: cd9c27841b7a5932c9897651e20b86c701dd740556989b01ca596fcfa3d49a0a

  - name: fmt
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DBUILD_SHARED_LIBS=OFF
      - -DFMT_DOC=OFF
      - -DFMT_TEST=OFF
      - -DFMT_INSTALL=ON
      - -DCMAKE_POSITION_INDEPENDENT_CODE=ON
    sources:
      - type: archive
        url: https://github.com/fmtlib/fmt/archive/refs/tags/10.2.1.tar.gz
        sha256: 1250e4cc58bf06ee631567523f48848dc4596133e163f02615c97f78bab6c811

  - name: spdlog
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DSPDLOG_BUILD_SHARED=OFF
      - -DSPDLOG_BUILD_EXAMPLE=OFF
      - -DSPDLOG_BUILD_TESTS=OFF
      - -DSPDLOG_FMT_EXTERNAL=ON
    sources:
      - type: archive
        url: https://github.com/gabime/spdlog/archive/refs/tags/v1.14.1.tar.gz
        sha256: 1586508029a7d0670dfcb2d97575dcdc242d3868a259742b69f100801ab4e16b

  - name: yaml-cpp
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DYAML_BUILD_SHARED_LIBS=OFF
      - -DYAML_CPP_BUILD_TESTS=OFF
      - -DYAML_CPP_BUILD_TOOLS=OFF
      - -DCMAKE_POSITION_INDEPENDENT_CODE=ON
    sources:
      - type: archive
        url: https://github.com/jbeder/yaml-cpp/archive/refs/tags/0.8.0.tar.gz
        sha256: fbe74bbdcee21d656715688706da3c8becfd946d92cd44705cc6098bb23b3a16

  - name: fftw
    buildsystem: autotools
    config-opts:
      - --disable-shared
      - --enable-static
      - --enable-threads
      - --enable-sse2
      - --enable-avx
    sources:
      - type: archive
        url: https://www.fftw.org/fftw-3.3.10.tar.gz
        sha256: 56c932549852cddcfafdab3820b0200c7742675be92179e59e6215b340e26467

  - name: qtnodes
    buildsystem: cmake-ninja
    builddir: true
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DUSE_QT6=ON
      - -DBUILD_TESTING=OFF
      - -DBUILD_EXAMPLES=OFF
      - -DBUILD_SHARED_LIBS=OFF
    sources:
      - type: git
        url: https://github.com/paceholder/nodeeditor
        commit: f953fcab52f505a74271c5f665d6627dce63b66d

  - name: decode-orc
    buildsystem: cmake-ninja
    builddir: true
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DBUILD_TESTS=OFF
      - -DBUILD_DOCS=OFF
      - -DBUILD_ENCODE_ORC=OFF
    sources:
      - type: dir
        path: .
